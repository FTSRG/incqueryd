\section{Incremental queries, change propagation}
\label{sec:incrementality}



\subsection{Rete}




\subsubsection{Detailed Rete with an actual instance model}


\myFigure{rete-routesensor-example-instances}{A modification on a \emph{\tb{}} instance model}

\myFigure{rete-routesensor-example-rete}{The Rete net and the partial matches stored in its nodes}


\subsubsection{Similar algorithms}

TREAT, LEAPS, newer Rete variants

TREAT \cite{Miranker:1991:OPT:627280.627434} 

LEAPS \cite{Batory:1994:LA:899216}



\subsection{Distributed operation}

% \emph{Information representation and distributed operation.}

The Rete layer of \iqd{} is \emph{domain and storage agnostic} as it stores only tuples constructed from model element identifiers and literals, thus it can be used independently of the model representation format (metamodeling language) of the model repository.
As illustrated in \figref{architecture}, the Rete nodes can be allocated to different hosts in a cloud computing infrastructure (as the underlying messaging framework, Akka, supports remoting). As change propagation is asynchronous, \iqd{} implements a \emph{termination protocol} to ensure that the query results can be retrieved consistently with the model state after a given transaction (i.e.\ by signaling when the update propagation has been terminated).


% \emph{Distributed pattern matcher.}




\subsubsection{Principles}


\subsubsection{Practice}

Transparent framework: Akka







\subsection{Scalability considerations}
For the storage layer, the most important issue from an incremental query evaluation perspective is that the indexers of the middleware should be filled as quickly as possible. This favors technologies where model sharding can be performed efficiently (i.e.\ with balanced shards in terms of type-instance relationships), and elementary queries (or model graph traversals) can be executed efficiently.

Achieving scalability of the distributed Rete architecture is an equally complex challenge. The overall performance of the system is influenced by a number of factors, including (i) the \emph{layout of the Rete network} (which can be optimized depending on both query and instance model characteristics, e.g.\ to keep the resource requirement of intermediate join operations to a minimum), (ii) the \emph{allocation} of Rete nodes to host computers (e.g.\ to optimize local resource usage, or to minimize the amount of remote network communication), and (iii) \emph{dynamic adaptability} to changing conditions (e.g.\ when the model size and thus query result size grows rapidly, the Rete network may require dynamic reallocation or node sharding due to local resource limitations).

